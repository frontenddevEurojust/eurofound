<?php

function ef_publication_field_formatter_views_pre_render(&$view){
	if($view->name=="ef_publications_view"){
		foreach ($view->result as $publication) {
			foreach ($publication->field_field_ef_observatory as $key => $value) {
				$to_change = $publication->field_field_ef_observatory[$key]['rendered']['#href'];
				$path_array = explode('/',$to_change);
				$term = $path_array[2];
				$new_path = url('publications', array('query'=>array('field_ef_observatory_tid[]'=>$term),'absolute' => TRUE));
				$publication->field_field_ef_observatory[$key]['rendered']['#href'] = $new_path;
			}
		}
	}
}
