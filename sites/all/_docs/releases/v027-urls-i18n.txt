drush sql-query "insert into schema_migrations(code,extra)values('027-urls-i18n', '...')"

drush vset -y maintenance_mode 1



:: MODULES ::

::i18n
drush en -y i18n_menu
drush en -y i18n_redirect
drush dl -y l10n_update
drush en -y i18n_block
drush en -y i18n_field
drush en -y i18n_panels
drush en -y i18n_select
drush en -y i18n_sync
drush en -y i18n_taxonomy
drush en -y i18n_variable
drush en -y l10n_update

drush dl -y i18nviews
drush en -y i18nviews

drush dl -y menu_position
drush en -y menu_position
drush cc all



:: PRE-FEATURES ::

:: fix-roles.txt
:: fix-panels.txt
:: fix-term-ids.txt



:: FEATURES ::

drush fr-all -y
drush cc all



:: POST-REVERT CONFIGURATIONS ::

:: to fix urls with transliteration:
:: goto admin/config/search/path
:: bulk delete all url aliases
:: bulk update all url aliases


:: notes for MI (ignore):
:: possibly not needed anymore due to menu re-importing and url aliases fixes
:: to fix main menu links for basic pages after urls change:
:: run listNodesByAutogeneratedTitleAlias($urlAliasMappings) of url-aliases-fixes to check duplicate urls for menu link nodes
:: ensure that the latest node from all nodes with same urls is selected as menu link in main menu and is the one with the content (if such exists)
:: run fixNodesByAutogeneratedTitleAlias($urlAliasMappings) of url-aliases-fixes to fix url to menu link applicable url for the latest node with the url alias for menu link nodes
:: check that the main menu links point to the right pages after the fix

:: to fix main menu links for basic pages after urls change:
:: windows (dev)
:: drush php-script --script-path=sites\all\_docs\php-scripts url-aliases-fixes
:: linux (stag)
drush -r /var/www/ef scr sites/all/_docs/php-scripts/url-aliases-fixes.php

:: goto admin/structure/pages/nojs/operation/page-emcc_landing_page/settings/basic
:: change path to observatories/emcc/index
:: goto admin/structure/pages/nojs/operation/page-eurwork_landing_page/settings/basic
:: change path to observatories/eurwork/index

:: import main menu:
:: with Link to existing content: Enabled
:: reimport-menu-links.txt

:: goto admin/config/search/path
:: bulk delete content url aliases
:: bulk update content url aliases

:: to fix main menu links for basic pages after urls change:
:: windows (dev)
:: drush php-script --script-path=sites\all\_docs\php-scripts url-aliases-fixes
:: linux (stag)
drush -r /var/www/ef scr sites/all/_docs/php-scripts/url-aliases-fixes.php

:: goto admin/structure/pages/nojs/operation/page-emcc_landing_page/settings/basic
:: change path to observatories/emcc
:: goto admin/structure/pages/nojs/operation/page-eurwork_landing_page/settings/basic
:: change path to observatories/eurwork

:: goto admin/structure/menu/manage/main-menu
:: edit emcc and eurwork menu link urls
:: observatories/emcc/index => observatories/emcc
:: observatories/eurwork/index => observatories/eurwork

:: manually create missing basic pages because of conflicts with views urls
:: e.g. Data Visualisation, parent: Search, weight: 4

:: Populate menu position rules.
:: windows (dev)
:: drush php-script --script-path=sites\all\_docs\php-scripts populate-menu-position-rules
:: linux (stag)
drush -r /var/www/ef scr sites/all/_docs/php-scripts/populate-menu-position-rules.php


:: goto admin/config/regional/language/configure
:: enable the following with this order:
:: Session: Determine the language from a request/session parameter.
:: URL: Determine the language from the URL (Path prefix or domain).
:: User: Follow the user's language preference.
:: Browser: Determine the language from the browser's language settings.
:: Default: Use the default site language (English).

:: goto admin/config/regional/language/update
:: store files: sites/all/translations

:: goto admin/config/regional/translate/update
:: update translations

:: goto admin/config/regional/i18n/strings
:: enable Filtered HTML, Full HTML and Plain Text

:: goto admin/config/regional/translate/i18n_string
:: select all



drush vset -y maintenance_mode 0
drush cc all
